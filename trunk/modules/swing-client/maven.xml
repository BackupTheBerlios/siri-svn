<project
    xmlns:ant="jelly:ant"
    xmlns:j="jelly:core"
    xmlns:deploy="deploy" >

<project xmlns:ant="jelly:ant" xmlns:j="jelly:core" xmlns:maven="jelly:maven">

    <!-- release goal is set as default for this project -->
    <goal name="release">
        <attainGoal name="jar:install"/>
    </goal>

    <goal name="jaxb:prepare-filesystem" description="Make any necessary directories for jaxb processing">
        <ant:mkdir dir="${maven.build.dir}/jaxb-generated/org/iris/client/settings/xml"/>
    </goal>

    <preGoal name="java:compile">
        <attainGoal name="jaxb:prepare-filesystem"/>
        <echo>[irisclient.xsd] Checking if we should invoke jaxb to generate new src files</echo>

        <ant:uptodate property="generateJaxbSource" targetfile="${basedir}/src/schema/irisclient.xsd">
            <srcfiles dir="${maven.build.dir}/jaxb-generated/org/iris/client/settings/xml" includes="**/*.java"/>
        </ant:uptodate>
        <j:choose>
            <j:when test="${generateJaxbSource}">
                <echo>[email.xsd] Invoking JAXB to regenerate source:</echo>
                <exec dir="${basedir}/src/schema" executable="${java.jaxb.generator}" os="Windows 2000" >
		 	<arg line="irisclient.xsd -d ../../target/jaxb-generated -p org.iris.client.settings.xml"/>
                </exec>
            </j:when>
            <j:otherwise>
                <echo message="[email.xsd] JAXB generation not necessairy source files newer than xsd file"/>
            </j:otherwise>
        </j:choose>
        <!--
        Append to maven src set
        -->
        <ant:path id="maven.jaxb.compile.src.set" location="${maven.build.dir}/jaxb-generated" />
        <maven:addPath id="maven.compile.src.set" refid="maven.jaxb.compile.src.set" />
    </preGoal>
</project>    
    
    
    <!--mkdir dir="${basedir}/target/jaxb-generated"/>
    <ant:uptodate property="generateJaxbSource" targetfile="${basedir}/src/schema/irisclient.xsd">
        <srcfiles dir="${basedir}/target/jaxb-generated" includes="**/*.java"/>
    </ant:uptodate>
    <j:choose>
        <j:when test="${generateJaxbSource}">
            <echo>[irisclient.xsd] Invoking JAXB to regenerate source:</echo>
            <exec dir="${basedir}/src/schema" executable="C:\java\jwsdp-1.3\jaxb\bin\xjc.bat" os="Windows XP" >
                <arg line="irisclient.xsd -d ../../target/jaxb-generated -p org.iris.client.settings.xml"/>
            </exec>
        </j:when>                                           
        <j:otherwise>
            <echo message="JAXB generation not necessairy source files newer than xsd file"/>
        </j:otherwise>
    </j:choose>


    <goal name="deploylocal">
            <echo>Copying jar to local deploy folder</echo>
            <copy file="${basedir}/target/iris-swing-client-1.0.0.jar" todir="c:/tradevision/irisclient/lib/" overwrite="true"/>
            <echo>Copying dependency jars to local deploy folder</echo>
            <deploy:copy-deps todir="c:/tradevision/irisclient/lib/" />
    </goal -->



</project>